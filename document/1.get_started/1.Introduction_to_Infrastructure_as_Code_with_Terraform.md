# Terraformを使ったinfrastructure as Codeについて
TerraformはHashiCorpから提供されているinfrastructure as codeツールです。
Terraformは、インフラのビルド、管理、修正を安全に繰り返し実現するためのツールです。

運用者やインフラチームはTeffaformを使って、可読性の高く自動生成されるHashiCorp Configuration Language (HCL)という構成管理言語で環境の管理を行えます。

## Infrastructure as Code
もし、あなたにとってinfrastructure as code(IaC)が馴染みのない概念である場合、
IaCはインフラを手作業でユーザダッシュボードなどのインターフェースを用いて構築するのでなく、
ファイルに記述された構成からインフラを管理する運用プロセスです。
対象となるリソースは、与えられた環境のあらゆるインフラリソース、例えばVirtualMachineやセキュリティグループ、ネットワークインタフェースなどです。

Terraformで運用者は異なる様々なサービス（AWS, GCP, GitHub, Dockerなど）の定義をHCLの定義に含めることができ、インフラの適用時にそれらのサービスへの反映も自動化できる。

この章では、AWSでのインフラ構築を例としてTerraformの基本の機能を説明する。

## Workflows
単純なデプロイのワークフローはすぐに以降の章で説明があります。
このトラックを通じて、これらのステップと概念を概観します。
なので、すぐに概念を理解できなかったとしても慌てる必要はありません。

1. Scope - 与えられたプロジェクトで作成するリソースを確認する
1. Author - HCLで規定されたパラメータを用いて構成を作成する
1. Initialize - `terraform init`を構成を定義したファイルを含むプロジェクトディレクトリで実行する。このコマンドで、適切なプラグインをダウンロードする。
1. Plan & Apply - `terraform plan`を実施して作成プロセスを確認できる。確認の後、`terraform apply`コマンドであなたの環境において定義した構成ファイルの通りに実際のリソースに反映できる。


## Advantages of Terraform
多くの利点をinfrastructure as codeにより運用者は自身の環境で得られる思われるが、
Terraformの利点は、どのような運用者や組織のサイズにも寄らず得られる利点を得るために作れれている。

- 異なるPlatformでの一貫性
- ステート運用管理
- 運用者の心理的安全性を確保


### Platform Agnostic
最近のデータセンターにおいて、運用者はいくつかの異なるクラウドやプラットフォームをアプリケーションによってサポートしているかもしれない。
Terraformを使えば、このような多様な環境でも同一のフローで、プロジェクトや組織毎に適した構成ファイルを作成することで管理することができる。


### State Management
Terraformはステートファイルを最初のプロジェクト初期化時に作成する。
Terraformはこのローカルのステートを使用して、planコマンド実行時のインフラの変更を作成する。
コマンド実行の前に必ずTerraformは実際のインフラの状態を見てからローカルのステートをアップデートする。
そのため、terraformコマンドを実施した時に見ることができるステートは実際のインフラの状態である。
もしローカルの構成ファイルに変更が行われたり、リソースが追加されたら、ステートファイルとこれらの変更を比較して、実際に行われる新しいリソースや修正を確認するができる。

### Operator Confidence
Terraformの構成ファイルをビルドするワークフローは、繰り返しを簡単にできる運用によってユーザにインストールされる。また、Terraformのplanコマンドによって行える確認のアクションは環境の破壊には繋がらないだろう。
ユーザは`terraform apply`で適用される変更をレビューすることを推奨される。
そして、ユーザは変更するとはっきりと意思表示が与えられ、さもなくば変更は実施されない。
